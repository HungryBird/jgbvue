<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>商品管理</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<link rel="stylesheet" type="text/css" href="../../font-awesome-4.7.0/css/font-awesome.css">
	<link rel="stylesheet" href="../../element-ui-2.0.11/lib/theme-chalk/index.css">
	<link rel="stylesheet" type="text/css" href="../../assets/css/common/common.css">
</head>
<body>
<div id="app" v-cloak>
	<el-container>
		<el-header style="padding: 0;">
			<el-form :inline="true">
				<el-form-item>
					<el-input placeholder="输入查询条件" v-model="search.input">
						<template slot="append">
							<el-button v-on:click="searchData(search.input)">搜索</el-button>
						</template>
					</el-input>
				</el-form-item>
				<el-form-item>
					<el-checkbox label="显示禁用商品" v-model="isShowForbiddenCommodity" v-on:change="toggleForbiddenCommdity"></el-checkbox>
				</el-form-item>
			</el-form>
		</el-header>
		<el-container>
			<el-aside width="200px" class="jgb-wrap">
				<div class="jgb-title">
					<h5 class="text-center">快速查询</h5>
				</div>
				<ul class="ul-list">
					<li v-for="(item, index) in queryType" :key="item.value" :value="item.value" v-on:click="changeQueryType(item, index)" :class="{active: index === activeIndex}">
						{{ item.label }}
					</li>
				</ul>
			</el-aside>
			<el-main>
				<div class="jgb-wrap">
					<nav class="jgb-nav">
						<el-button class="pull-left" v-on:click="showColumnSetting = true">
							列设置
						</el-button>
						<el-button-group class="pull-right">
							<el-button icon="el-icon-plus" v-on:click="addVisible = true">新增</el-button>
							<el-button icon="el-icon-minus" :disabled="selectedRows.length === 0" v-on:click="remove">删除</el-button>
							<el-button :disabled="selectedRows.length === 0" v-on:click="forbidden">禁用</el-button>
							<el-button :disabled="selectedRows.length === 0" v-on:click="startUsing">启用</el-button>
							<el-button v-on:click="importVisible = true">导入</el-button>
							<el-button v-on:click="exportCilck">导出</el-button>
						</el-button-group>
					</nav>
					<el-table :data="table.data" ref="table" border v-on:row-click="rowClick" :data="table" v-on:select-all="selectAll" v-on:select="selectItem" :row-class-name="rowStatusClassName" v-loading="loadingDetailInfo">
						<el-table-column type="selection"></el-table-column>
						<el-table-column  v-for="item in table.header" v-if="item.enable" align="center" :type="item.type" :sortable="item.sortable" :width="item.width" :key="item.prop" :prop="item.prop" :label="item.label">
							<template slot-scope="scope">
								<div v-if="item.prop == 'action'" >
									<el-button-group>
										<el-button size="mini" v-on:click="handleExamine(scope.$index, scope.row)" type="primary">查看</el-button>
										<el-button size="mini" v-on:click="handleEdit(scope.$index, scope.row)">编辑</el-button>
									</el-button-group>
								</div>
								<div v-else-if="item.type == 'index'">{{scope.$index+1}}</div>
								<div v-else-if="item.prop == 'status'">
									<el-switch v-model="scope.row.status" v-on:change="handleStatus(scope.$index, scope.row)"></el-switch>
								</div>
								<div v-else-if="item.prop == 'image'">
									<i class="el-icon-picture jgb-table-icon" v-on:click="viewImage(scope.row.img, scope.row)"></i>
								</div>
								<i v-else-if="item.prop == 'isCommonUse'" :class="{'el-icon-star-on': scope.row.isCommonUse, 'el-icon-star-off': !scope.row.isCommonUse}" class="jgb-table-icon" style="color: #FFD700;" v-on:click="toggleCommonUse(scope.row)"></i>
                  				<div v-else>{{scope.row[item.prop]}}</div>
							</template>
						</el-table-column>
					</el-table>
				</div>
			</el-main>
		</el-container>
	</el-container>
	<!-- 新增商品 -->
	<el-dialog :visible.sync="addVisible" title="新增商品">
		<el-form ref="addForm" label-position="right" label-width="100px" :model="addForm" :rules="formRules">
			<el-row>
				<el-col :span="24">
					<h3>
						基础资料
						<a class="fa fa-video-camera icon-link"></a>
					</h3>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="number" label="商品编号">
						<el-input v-model="addForm.number" v-on:blur="addCheckNumberIsRepeat"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="name" label="商品名称">
						<el-input v-model="addForm.name"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="barCode" label="商品条码">
						<el-input v-model="addForm.barCode"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="specifications" label="规格型号">
						<el-input v-model="addForm.specifications"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="commodityCategory" label="商品类别">
						<el-select v-model="addForm.commodityCategory">
							<el-option v-for="item in addFormBasicData.commodityCategory" :value="item.value" :key="item.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="primaryRepo" label="首选仓库">
						<el-select v-model="addForm.primaryRepo">
							<el-option v-for="item in addFormBasicData.primaryRepo" :value="item.value" :key="item.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="commodityBrand" label="商品品牌">
						<el-input v-model="addForm.commodityBrand"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="unitOfMeasurement" label="计量单位" v-if="!addForm.multiple">
						<el-select v-model="addForm.unitOfMeasurement">
							<el-option v-for="item in addFormBasicData.unitOfMeasurement" :value="item.value" :key="item.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="multiple" label="多单位">
						<el-checkbox border v-model="addForm.multiple"></el-checkbox>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12" v-if="addForm.multiple">
					<el-form-item prop="multipleTotalOption" label="多单位选择">
						<el-select v-model="addForm.multipleTotalOption" clearable v-on:change="addChangeMultipleTotalSelect">
							<el-option v-for="mo in multipleTotalOption" :key="mo.value" :value="mo.value" :label="mo.label"></el-option>
							<div v-on:click="addNewMultipleDialogVisible = true" class="el-select-dropdown__item">
								<span style="float: left" class="el-icon-plus"></span>
								<span style="float: left; color: #8492a6; font-size: 13px">新增单位</span>
							</div>
						</el-select>
					</el-form-item>
				</el-col>
				<el-col :span="12" v-if="addForm.multiple">
					<el-form-item prop="multiplePreferredOutOption" label="首选出库单位">
						<el-select v-model="addForm.multiplePreferredOutOption" clearable>
							<el-option v-for="mo in addMultiplePreferredOutOption" :key="mo.value" :value="mo.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12" v-if="addForm.multiple">
					<el-form-item prop="multiplePreferredEnterOption" label="首选入库单位">
						<el-select v-model="addForm.multiplePreferredEnterOption" clearable>
							<el-option v-for="mo in addMultiplePreferredEnterOption" :key="mo.value" :value="mo.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row v-if="!addForm.setCommodityAuxiliaryAttributes||addForm.multiple">
				<el-col :span="24">
					<h3 title="各销售价格分别对应客户信息中的客户等级，如：零售价-零售客户，批发价-批发客户...开单时选择客户后再选择该商品，可自动填写相应的价格或折扣">
						价格策略
						<a class="fa fa-video-camera icon-link"></a>
					</h3>
				</el-col>
			</el-row>
			<!-- 表格 -->
			<el-table v-if="addForm.multiple" ref="addMultipleTable" :data="addForm.multipleTable" border v-on:row-click="addMultipleTableRowClick">
				<el-table-column label="单位名字" prop="unitName"></el-table-column>
				<el-table-column label="计量单位" prop="unitOfMeasurement"></el-table-column>
				<el-table-column label="零售价" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="批发价" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="VIP会员价" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="折扣率一(%)" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="折扣率二(%)" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="预计采购价" prop="expectPurchasePrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.expectPurchasePrice }}</div>
						<el-input v-else v-model="scope.row.expectPurchasePrice"></el-input>
					</template>
				</el-table-column>
			</el-table>
			<el-row :gutter="4" v-if="!addForm.multiple&&!addForm.setCommodityAuxiliaryAttributes">
				<el-col :span="12">
					<el-form-item prop="retailPrice" label="零售价">
						<el-input v-model="addForm.retailPrice"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="tradePrice" label="批发价">
						<el-input v-model="addForm.tradePrice"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4" v-if="!addForm.multiple&&!addForm.setCommodityAuxiliaryAttributes">
				<el-col :span="12">
					<el-form-item prop="lowestPrince" label="最低价">
						<el-input v-model="addForm.lowestPrince"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="heighestPrince" label="最高价">
						<el-input v-model="addForm.heighestPrince"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4" v-if="!addForm.multiple&&!addForm.setCommodityAuxiliaryAttributes">
				<el-col :span="12">
					<el-form-item prop="discountRate1" label="折扣率一(%)">
						<el-input v-model="addForm.discountRate1"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="discountRate3" label="折扣率二(%)">
						<el-input v-model="addForm.discountRate2"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4" v-if="!addForm.multiple&&!addForm.setCommodityAuxiliaryAttributes">
				<el-col :span="12">
					<el-form-item prop="discountRate3" label="折扣率三(%)">
						<el-input v-model="addForm.discountRate3"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="expectPurchasePrice" label="预计采购价">
						<el-input v-model="addForm.expectPurchasePrice"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-form-item prop="remark" label="备注">
						<el-input v-model="addForm.remark" type="textarea"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<h3>添加商品图册</h3>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-upload action="/common/upload_img" :file-list="addForm.upload" list-type="picture-card" :limit="20" :on-remove="handleRemove" :auto-upload="false">
						<div slot="tip" class="el-upload__tip">最多20张</div>
						<i class="el-icon-plus"></i>
					</el-upload>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="addForm.inventoryWarning">
						<h3>库存预警</h3>
					</el-checkbox>
					<a class="fa fa-video-camera icon-link"></a>
				</el-col>
				<el-col :span="24" v-if="addForm.inventoryWarning" style="padding: 10px;">
					<el-checkbox v-model="addForm.branchWarehouseWarning">启用分仓预警</el-checkbox>
				</el-col>
				<el-col :span="24" v-if="addForm.inventoryWarning&&!addForm.branchWarehouseWarning" style="padding: 10px;padding-top: 0;">
					<el-row :gutter="4">
						<el-form :model="addForm" label-position="top">
							<el-col :span="12">
								<el-form-item label="最低库存">
									<el-input v-model="addForm.lowestInventory"></el-input>
								</el-form-item>
							</el-col>
							<el-col :span="12">
								<el-form-item label="最高库存">
									<el-input v-model="addForm.highestInventory"></el-input>
								</el-form-item>
							</el-col>
						</el-form>
					</el-row>
				</el-col>
				<div v-if="addForm.inventoryWarning&&addForm.branchWarehouseWarning">
					<el-table :data="addForm.repo" border ref="addinventoryWarningTable" v-on:row-click="addRowClick">
						<el-table-column type="index" width="50px" label="序号"></el-table-column>
						<el-table-column label="仓库" prop="label"></el-table-column>
						<el-table-column :render-header="addLowestInventoryHeader" label="最低库存">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.lowestInventory }}</div>
								<el-input v-else v-model="scope.row.lowestInventory"></el-input>
							</template>
						</el-table-column>
						<el-table-column :render-header="addHighestInventoryHeader" label="最高库存">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.highestInventory }}</div>
								<el-input v-else v-model="scope.row.highestInventory"></el-input>
							</template>
						</el-table-column>
					</el-table>
				</div>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="addForm.setCommodityAuxiliaryAttributes">
						<h3>设置商品辅助属性</h3>
					</el-checkbox>
					<a class="fa fa-video-camera icon-link"></a>
				</el-col>
				<el-col :span="24" v-if="addForm.setCommodityAuxiliaryAttributes" style="padding: 10px;padding-top: 0;">
					<h4>辅助属性分类</h4>
					<el-checkbox-group v-model="addForm.auxiliaryAttributesClassify" v-on:change="addChangeAuxiliaryAttributesClassify" class="pull-left" style="padding-right: 5px;">
						<el-checkbox v-for="item in auxiliaryAttributesClassify" :key="item.label" :label="item.value">{{ item.label }}</el-checkbox>
					</el-checkbox-group>
					<el-button icon="el-icon-plus" size="mini" class="pull-left" v-on:click="addAuxiliaryAttributesClassify">新增属性分类</el-button>
					<div style="clear: both;"></div>
					<div style="padding: 5px;border-top: 1px solid #ddd;margin-top: 5px;" v-for="item in addSelectedAxiliaryAttributesClassify" :key="item.label">
						<h5 class="pull-left" style="padding-right: 10px;">{{ item.parentName }}</h5>
						<el-checkbox-group class="pull-left" v-model="auxiliaryAttributesClassifyChildren">
							<el-checkbox v-for="c in item.children" :key="c.value" :label="c.value">{{ c.label }}</el-checkbox>
						</el-checkbox-group>
						<div style="clear: both;"></div>
					</div>
					<div style="padding: 5px 0;">
						<label>
							<strong>自动建立属性组合</strong>
						</label>
						<span>(自动建立组合只能选择三个属性分类)</span>
						<el-button size="mini" v-on:click="quickGenerate('addForm')">快速生成</el-button>
						<el-table :data="addForm.quickGenerateTable.data" ref="addQuickGenerateTable" border v-on:row-click="addQuickGenerateRowClick">
							<el-table-column label="序号" width="50px" type="index"></el-table-column>
							<el-table-column label="操作">
								<template slot-scope="scope">
									<el-button-group>
										<el-button v-on:click="quickGenerateTable_add_btn('addForm')" icon="el-icon-plus" size="small"></el-button>
										<el-button v-on:click="quickGenerateTable_delete_btn(scope.row, addForm)" icon="el-icon-delete" size="small" type="danger"></el-button>
									</el-button-group>
								</template>
							</el-table-column>
							<el-table-column label="图片" prop="img">
								<template slot-scope="scope">
									<i class="el-icon-picture jgb-table-icon"></i>
									<input type="file" v-on:change="quickGenerateUploadPic($event, addForm.quickGenerateTable.data, scope.row)" style="width: 100%;height: 100%;z-index: 9;position: absolute;left: 0;top: 0;opacity: 0;"></input>
								</template>
							</el-table-column>
							<el-table-column v-for="(tb, index) in addForm.quickGenerateTable.header" :key="tb.label" :prop="tb.prop" :label="tb.label" :render-header="quickGenerateHeader">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row[tb.label] }}</div>
									<el-select v-model="scope.row[tb.prop]" filterable allow-create v-else v-on:focus="selectQuickGenerateOption(tb.prop)">
										<el-option v-for="o in quickGenerateOption" :value="o.value" :key="o.label">
											{{ o.label }}
										</el-option>
										<div v-on:click="addNewAttribute(scope.row, tb.prop)" class="el-select-dropdown__item">
											<span style="float: left" class="el-icon-plus"></span>
      										<span style="float: left; color: #8492a6; font-size: 13px">新增属性</span>
										</div>
									</el-select>
								</template>
							</el-table-column>
							<el-table-column label="属性编号" prop="attributesNumber" :render-header="quickGenerateHeader">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.attributesNumber }}</div>
									<el-input v-else v-model="scope.row.attributesNumber" v-on:blur="addCheckAttributesNumber(scope.row.attributesNumber)"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="属性条码" prop="attributesBarCode">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.attributesBarCode }}</div>
									<el-input v-else v-model="scope.row.attributesBarCode"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="零售价" prop="retailPrice">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
									<el-input v-else v-model="scope.row.retailPrice" :disabled="addForm.multiple"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="批发价" prop="tradePrice">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.tradePrice }}</div>
									<el-input v-else v-model="scope.row.tradePrice" :disabled="addForm.multiple"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="VIP价" prop="VIPPrice">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.VIPPrice }}</div>
									<el-input v-else v-model="scope.row.VIPPrice" :disabled="addForm.multiple"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="折扣率一" prop="discountRate1">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.discountRate1 }}</div>
									<el-input v-else v-model="scope.row.discountRate1" :disabled="addForm.multiple"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="折扣率二" prop="discountRate2">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.discountRate2 }}</div>
									<el-input v-else v-model="scope.row.discountRate2" :disabled="addForm.multiple"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="预计采购价" prop="expectPurchasePrice">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.expectPurchasePrice }}</div>
									<el-input v-else v-model="scope.row.expectPurchasePrice" :disabled="addForm.multiple"></el-input>
								</template>
							</el-table-column>
						</el-table>
					</div>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="addForm.batchExpirationDateManagement" :disabled="addForm.serialNumberManagement" v-on:change="addToggleBatchExpirationDateManagement">
						<h3>启用批次保质期管理</h3>
					</el-checkbox>
				</el-col>
			</el-row>
			<el-row v-if="addForm.batchExpirationDateManagement">
				<el-col :span="12">
					<el-form-item label="保质期天数" prop="shelfLife">
						<el-input v-model="addForm.shelfLife" v-on:blur="addChangeShelfLife" type="number"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item label="报警天数" prop="alarmDate">
						<el-input v-model="addForm.alarmDate" type="number"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="addForm.serialNumberManagement" :disabled="addForm.batchExpirationDateManagement" v-on:change="addUsingSerialNumberManagement">
						<h3>启用序列号管理</h3>
					</el-checkbox>
					<a class="fa fa-video-camera icon-link"></a>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="addForm.initSet">
						<h3>期初设置</h3>
					</el-checkbox>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-table :data="addForm.initSetTable" border ref="addInitSetTable" v-on:row-click="addRowClickInitSetTable" v-if="addForm.initSet">
						<el-table-column type="index" label="序号" width="50px"></el-table-column>
						<el-table-column label="操作">
							<template slot-scope="scope">
								<el-button-group>
									<el-button size="mini" v-on:click="handleAddInitSetAdd(scope.$index, scope.row)" size="small" icon="el-icon-plus"></el-button>
									<el-button size="mini" type="danger" v-on:click="handleAddInitSetDelete(scope.$index, scope.row)" size="small" icon="el-icon-delete"></el-button>
								</el-button-group>
							</template>
						</el-table-column>
						<el-table-column label="仓库" prop="repo" :render-header="requiredHeader">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.repo }}</div>
								<!-- <el-input v-else v-model="scope.row.repo"></el-input> -->
								<el-select v-model="scope.row.repo">
									<el-option></el-option>
								</el-select>
							</template>
						</el-table-column>
						<el-table-column label="属性" prop="attribute">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.attribute }}</div>
								<!-- <el-input v-else v-model="scope.row.attribute"></el-input> -->
								<el-select v-model="scope.row.attribute">
									<el-option></el-option>
								</el-select>
							</template>
						</el-table-column>
						<el-table-column v-for="ai in add_initSetTable_header" :label="ai.label" :key="ai.prop" >
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag&&ai.type !== 'date'">{{ scope.row[ai.prop] }}</div>
								<div v-else-if="!scope.row.editFlag&&ai.type === 'date'">{{ scope.row[ai.prop] | formatDate }}</div>
								<el-date-picker v-model="scope.row[ai.prop]" type="date" placeholder="选择日期" v-else-if="ai.type === 'date'" v-on:change="(value)=>addFormInitSetTablePickDate(value, scope.row, ai.prop)"></el-date-picker>
								<div v-else-if="scope.row.editFlag&&ai.type === 'text'">{{ scope.row[ai.prop] }}</div>
								<el-input v-else v-model="scope.row[ai.prop]"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="产地" prop="periodOfValidity">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.periodOfValidity }}</div>
								<el-input v-else v-model="scope.row.periodOfValidity"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="注册证号" prop="registrationNumber">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.registrationNumber }}</div>
								<el-input v-else v-model="scope.row.registrationNumber"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="生产许可证" prop="licence">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.licence }}</div>
								<el-input v-else v-model="scope.row.licence"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="期初数量" prop="initialNumber" :render-header="requiredHeader">
							<template slot-scope="scope">
								<div v-if="addForm.serialNumberManagement" v-on:click="addEnterSerialNumberVisible = true">
									<el-button v-show="addForm.enterSerialNumberTable.length === 0" size="small">录入</el-button>
									<div class="pull-right" v-show="addForm.enterSerialNumberTable.length !== 0">{{ addForm.enterSerialNumberTable.length }}</div>
									<div class="pull-right jgb-brand" v-show="addForm.enterSerialNumberTable.length !== 0">SN</div>
									<div class="jgb-clearFloat">.</div>
								</div>
								<div v-else-if="!scope.row.editFlag&&!addForm.serialNumberManagement&&addForm.initSet">{{ scope.row.initialNumber }}</div>
								<el-input v-else v-model="scope.row.initialNumber" type="number" v-on:change="(value)=>addFormInitialNumberChange(value, scope.row)"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="单位成本" prop="unitCost">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.unitCost | doubleDecimals }}</div>
								<el-input v-else v-model="scope.row.unitCost" v-on:change="(value)=>addFormUnitCostChange(value, scope.row)"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="起初总价" prop="atFirstTotalPrice">
							<template slot-scope="scope">
								{{ scope.row.atFirstTotalPrice | doubleDecimals }}
							</template>
						</el-table-column>
					</el-table>
				</el-col>
			</el-row>
		</el-form>
		<div slot="footer">
			<jgb-form-footer :loading="loading" v-on:save="saveAdd('addForm')" v-on:close="addVisible = false"></jgb-form-footer>
		</div>
	</el-dialog>
	<!-- 编辑商品 -->
	<el-dialog :visible.sync="editVisible" title="编辑商品">
		<el-form ref="editForm" label-position="right" label-width="100px" :model="editForm" :rules="formRules">
			<el-row>
				<el-col :span="24">
					<h3>
						基础资料
						<a class="fa fa-video-camera icon-link"></a>
					</h3>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="number" label="商品编号">
						<el-input v-model="editForm.number" v-on:blur="editCheckNumberIsRepeat"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="name" label="商品名称">
						<el-input v-model="editForm.name"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="barCode" label="商品条码">
						<el-input v-model="editForm.barCode"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="specifications" label="规格型号">
						<el-input v-model="editForm.specifications"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="commodityCategory" label="商品类别">
						<el-select v-model="editForm.commodityCategory">
							<el-option v-for="item in editFormBasicData.commodityCategory" :value="item.value" :key="item.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="primaryRepo" label="首选仓库">
						<el-select v-model="editForm.primaryRepo">
							<el-option v-for="item in editFormBasicData.primaryRepo" :value="item.value" :key="item.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="commodityBrand" label="商品品牌">
						<el-input v-model="editForm.commodityBrand"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="unitOfMeasurement" label="计量单位">
						<el-select v-model="editForm.unitOfMeasurement">
							<el-option v-for="item in editFormBasicData.unitOfMeasurement" :value="item.value" :key="item.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12">
					<el-form-item prop="multiple" label="多单位">
						<el-checkbox border v-model="editForm.multiple"></el-checkbox>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12" v-if="editForm.multiple">
					<el-form-item prop="multipleTotalOption" label="多单位选择">
						<el-select v-model="editForm.multipleTotalOption" clearable v-on:change="editChangeMultipleTotalSelect">
							<el-option v-for="mo in multipleTotalOption" :key="mo.value" :value="mo.value" :label="mo.label"></el-option>
							<div v-on:click="addNewMultipleDialogVisible = true" class="el-select-dropdown__item">
								<span style="float: left" class="el-icon-plus"></span>
								<span style="float: left; color: #8492a6; font-size: 13px">新增单位</span>
							</div>
						</el-select>
					</el-form-item>
				</el-col>
				<el-col :span="12" v-if="editForm.multiple">
					<el-form-item prop="multiplePreferredOutOption" label="首选出库单位">
						<el-select v-model="editForm.multiplePreferredOutOption" clearable>
							<el-option v-for="mo in editMultiplePreferredOutOption" :key="mo.value" :value="mo.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4">
				<el-col :span="12" v-if="editForm.multiple">
					<el-form-item prop="multiplePreferredEnterOption" label="首选入库单位">
						<el-select v-model="editForm.multiplePreferredEnterOption" clearable>
							<el-option v-for="mo in editMultiplePreferredEnterOption" :key="mo.value" :value="mo.value"></el-option>
						</el-select>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row v-if="!editForm.setCommodityAuxiliaryAttributes||editForm.multiple">
				<el-col :span="24">
					<h3 title="各销售价格分别对应客户信息中的客户等级，如：零售价-零售客户，批发价-批发客户...开单时选择客户后再选择该商品，可自动填写相应的价格或折扣">
						价格策略
						<a class="fa fa-video-camera icon-link"></a>
					</h3>
				</el-col>
			</el-row>
			<!-- 表格 -->
			<el-table v-if="editForm.multiple" ref="editMultipleTable" :data="editForm.multipleTable" border v-on:row-click="editMultipleTableRowClick">
				<el-table-column label="单位名字" prop="unitName"></el-table-column>
				<el-table-column label="计量单位" prop="unitOfMeasurement"></el-table-column>
				<el-table-column label="零售价" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="批发价" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="VIP会员价" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="折扣率一(%)" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="折扣率二(%)" prop="retailPrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
						<el-input v-else v-model="scope.row.retailPrice"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="预计采购价" prop="expectPurchasePrice">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.expectPurchasePrice }}</div>
						<el-input v-else v-model="scope.row.expectPurchasePrice"></el-input>
					</template>
				</el-table-column>
			</el-table>
			<el-row :gutter="4" v-if="!editForm.multiple&&!editForm.setCommodityAuxiliaryAttributes">
				<el-col :span="12">
					<el-form-item prop="retailPrice" label="零售价">
						<el-input v-model="editForm.retailPrice"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="tradePrice" label="批发价">
						<el-input v-model="editForm.tradePrice"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4" v-if="!addForm.multiple&&!addForm.setCommodityAuxiliaryAttributes">
				<el-col :span="12">
					<el-form-item prop="lowestPrince" label="最低价">
						<el-input v-model="editForm.lowestPrince"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="heighestPrince" label="最高价">
						<el-input v-model="editForm.heighestPrince"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4" v-if="!addForm.multiple&&!addForm.setCommodityAuxiliaryAttributes">
				<el-col :span="12">
					<el-form-item prop="discountRate1" label="折扣率一(%)">
						<el-input v-model="editForm.discountRate1"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="discountRate3" label="折扣率二(%)">
						<el-input v-model="editForm.discountRate2"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row :gutter="4" v-if="!addForm.multiple&&!addForm.setCommodityAuxiliaryAttributes">
				<el-col :span="12">
					<el-form-item prop="discountRate3" label="折扣率三(%)">
						<el-input v-model="editForm.discountRate3"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item prop="expectPurchasePrice" label="预计采购价">
						<el-input v-model="editForm.expectPurchasePrice"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-form-item prop="remark" label="备注">
						<el-input v-model="editForm.remark" type="textarea"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<h3>添加商品图册</h3>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-upload action="/common/upload_img" :file-list="editForm.upload" list-type="picture-card" :limit="20" :on-remove="handleRemove" :auto-upload="false">
						<div slot="tip" class="el-upload__tip">最多20张</div>
						<i class="el-icon-plus"></i>
					</el-upload>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="editForm.inventoryWarning">
						<h3>库存预警</h3>
					</el-checkbox>
					<a class="fa fa-video-camera icon-link"></a>
				</el-col>
				<el-col :span="24" v-if="editForm.inventoryWarning" style="padding: 10px;">
					<el-checkbox v-model="editForm.branchWarehouseWarning">启用分仓预警</el-checkbox>
				</el-col>
				<el-col :span="24" v-if="editForm.inventoryWarning&&!editForm.branchWarehouseWarning" style="padding: 10px;padding-top: 0;">
					<el-row :gutter="4">
						<el-form :model="editForm" label-position="top">
							<el-col :span="12">
								<el-form-item label="最低库存">
									<el-input v-model="editForm.lowestInventory"></el-input>
								</el-form-item>
							</el-col>
							<el-col :span="12">
								<el-form-item label="最高库存">
									<el-input v-model="editForm.highestInventory"></el-input>
								</el-form-item>
							</el-col>
						</el-form>
					</el-row>
				</el-col>
				<div v-if="editForm.inventoryWarning&&editForm.branchWarehouseWarning">
					<el-table :data="editForm.repo" border ref="editInventoryWarningTable" v-on:row-click="addRowClick">
						<el-table-column type="index" width="50px" label="序号"></el-table-column>
						<el-table-column label="仓库" prop="label"></el-table-column>
						<el-table-column :render-header="editLowestInventoryHeader" label="最低库存">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.lowestInventory }}</div>
								<el-input v-else v-model="scope.row.lowestInventory"></el-input>
							</template>
						</el-table-column>
						<el-table-column :render-header="editHighestInventoryHeader" label="最高库存">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.highestInventory }}</div>
								<el-input v-else v-model="scope.row.highestInventory"></el-input>
							</template>
						</el-table-column>
					</el-table>
				</div>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="editForm.setCommodityAuxiliaryAttributes">
						<h3>设置商品辅助属性</h3>
					</el-checkbox>
					<a class="fa fa-video-camera icon-link"></a>
				</el-col>
				<el-col :span="24" v-if="editForm.setCommodityAuxiliaryAttributes" style="padding: 10px;padding-top: 0;">
					<h4>辅助属性分类</h4>
					<el-checkbox-group v-model="editForm.auxiliaryAttributesClassify" v-on:change="editChangeAuxiliaryAttributesClassify" class="pull-left" style="padding-right: 5px;">
						<el-checkbox v-for="item in auxiliaryAttributesClassify" :key="item.label" :label="item.value">{{ item.label }}</el-checkbox>
					</el-checkbox-group>
					<el-button icon="el-icon-plus" size="mini" class="pull-left" v-on:click="addAuxiliaryAttributesClassify">新增属性分类</el-button>
					<div style="clear: both;"></div>
					<div style="padding: 5px;border-top: 1px solid #ddd;margin-top: 5px;" v-for="item in editSelectedAxiliaryAttributesClassify" :key="item.label">
						<h5 class="pull-left" style="padding-right: 10px;">{{ item.parentName }}</h5>
						<el-checkbox-group class="pull-left" v-model="auxiliaryAttributesClassifyChildren" v-on:change="editChangeAuxiliaryAttributesClassifyChildren">
							<el-checkbox v-for="c in item.children" :key="c.value" :label="c.value">{{ c.label }}</el-checkbox>
						</el-checkbox-group>
						<div style="clear: both;"></div>
					</div>
					<div style="padding: 5px 0;">
						<label>
							<strong>自动建立属性组合</strong>
						</label>
						<span>(自动建立组合只能选择三个属性分类)</span>
						<el-button size="mini" v-on:click="quickGenerate('editForm')">快速生成</el-button>
						<el-table :data="editForm.quickGenerateTable.data" ref="editQuickGenerateTable" border v-on:row-click="editQuickGenerateRowClick">
							<el-table-column label="序号" width="50px" type="index"></el-table-column>
							<el-table-column label="操作">
								<template slot-scope="scope">
									<el-button-group>
										<el-button v-on:click="quickGenerateTable_add_btn('editForm')" icon="el-icon-plus" size="small"></el-button>
										<el-button v-on:click="quickGenerateTable_delete_btn(scope.row, editForm)" icon="el-icon-delete" size="small" type="danger"></el-button>
									</el-button-group>
								</template>
							</el-table-column>
							<el-table-column label="图片" prop="img">
								<template slot-scope="scope">
									<i class="el-icon-picture jgb-table-icon"></i>
									<input type="file" v-on:change="quickGenerateUploadPic($event, editForm.quickGenerateTable.data, scope.row)" style="width: 100%;height: 100%;z-index: 9;position: absolute;left: 0;top: 0;opacity: 0;"></input>
								</template>
							</el-table-column>
							<el-table-column v-for="(tb, index) in editForm.quickGenerateTable.header" :key="tb.label" :prop="tb.prop" :label="tb.label" :render-header="quickGenerateHeader">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row[tb.label] }}</div>
									<el-select v-model="scope.row[tb.prop]" filterable allow-create v-else v-on:focus="selectQuickGenerateOption(tb.prop)">
										<el-option v-for="o in quickGenerateOption" :value="o.value" :key="o.label">
											{{ o.label }}
										</el-option>
										<div v-on:click="addNewAttribute(scope.row, tb.prop)" class="el-select-dropdown__item">
											<span style="float: left" class="el-icon-plus"></span>
      										<span style="float: left; color: #8492a6; font-size: 13px">新增属性</span>
										</div>
									</el-select>
								</template>
							</el-table-column>
							<el-table-column label="属性编号" prop="attributesNumber" :render-header="quickGenerateHeader">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.attributesNumber }}</div>
									<el-input v-else v-model="scope.row.attributesNumber" v-on:blur="addCheckAttributesNumber(scope.row.attributesNumber)"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="属性条码" prop="attributesBarCode">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.attributesBarCode }}</div>
									<el-input v-else v-model="scope.row.attributesBarCode"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="零售价" prop="retailPrice">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.retailPrice }}</div>
									<el-input v-else v-model="scope.row.retailPrice"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="批发价" prop="tradePrice">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.tradePrice }}</div>
									<el-input v-else v-model="scope.row.tradePrice"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="VIP价" prop="VIPPrice">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.VIPPrice }}</div>
									<el-input v-else v-model="scope.row.VIPPrice"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="折扣率一" prop="discountRate1">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.discountRate1 }}</div>
									<el-input v-else v-model="scope.row.discountRate1"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="折扣率二" prop="discountRate2">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.discountRate2 }}</div>
									<el-input v-else v-model="scope.row.discountRate2"></el-input>
								</template>
							</el-table-column>
							<el-table-column label="预计采购价" prop="expectPurchasePrice">
								<template slot-scope="scope">
									<div v-if="!scope.row.editFlag">{{ scope.row.expectPurchasePrice }}</div>
									<el-input v-else v-model="scope.row.expectPurchasePrice"></el-input>
								</template>
							</el-table-column>
						</el-table>
					</div>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="editForm.batchExpirationDateManagement" :disabled="editForm.serialNumberManagement" v-on:change="editToggleBatchExpirationDateManagement">
						<h3>启用批次保质期管理</h3>
					</el-checkbox>
				</el-col>
			</el-row>
			<el-row v-if="editForm.batchExpirationDateManagement">
				<el-col :span="12">
					<el-form-item label="保质期天数" prop="shelfLife">
						<el-input v-model="editForm.shelfLife" v-on:blur="editChangeShelfLife" type="number"></el-input>
					</el-form-item>
				</el-col>
				<el-col :span="12">
					<el-form-item label="报警天数" prop="alarmDate">
						<el-input v-model="editForm.alarmDate" type="number"></el-input>
					</el-form-item>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="editForm.serialNumberManagement" :disabled="editForm.batchExpirationDateManagement" v-on:change="editUsingSerialNumberManagement">
						<h3>启用序列号管理</h3>
					</el-checkbox>
					<a class="fa fa-video-camera icon-link"></a>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-checkbox v-model="editForm.initSet">
						<h3>期初设置</h3>
					</el-checkbox>
				</el-col>
			</el-row>
			<el-row>
				<el-col :span="24">
					<el-table :data="editForm.initSetTable" border ref="addInitSetTable" v-on:row-click="addRowClickInitSetTable" v-if="editForm.initSet">
						<el-table-column type="index" label="序号" width="50px"></el-table-column>
						<el-table-column label="操作">
							<template slot-scope="scope">
								<el-button-group>
									<el-button size="mini" v-on:click="handleEditInitSetAdd(scope.$index, scope.row)" size="small" icon="el-icon-plus"></el-button>
									<el-button size="mini" type="danger" v-on:click="handleEditInitSetDelete(scope.$index, scope.row)" size="small" icon="el-icon-delete"></el-button>
								</el-button-group>
							</template>
						</el-table-column>
						<el-table-column label="仓库" prop="repo" :render-header="requiredHeader">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.repo }}</div>
								<el-input v-else v-model="scope.row.repo"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="属性" prop="attribute">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.attribute }}</div>
								<el-input v-else v-model="scope.row.attribute"></el-input>
							</template>
						</el-table-column>
						<el-table-column v-for="ai in edit_initSetTable_header" :label="ai.label" :key="ai.prop" >
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag&&ai.type !== 'date'">{{ scope.row[ai.prop] }}</div>
								<div v-else-if="!scope.row.editFlag&&ai.type === 'date'">{{ scope.row[ai.prop] | formatDate }}</div>
								<el-date-picker v-model="scope.row[ai.prop]" type="date" placeholder="选择日期" v-else-if="ai.type === 'date'" v-on:change="(value)=>editFormInitSetTablePickDate(value, scope.row, ai.prop)"></el-date-picker>
								<div v-else-if="scope.row.editFlag&&ai.type === 'text'">{{ scope.row[ai.prop] }}</div>
								<el-input v-else v-model="scope.row[ai.prop]"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="产地" prop="periodOfValidity">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.periodOfValidity }}</div>
								<el-input v-else v-model="scope.row.periodOfValidity"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="注册证号" prop="registrationNumber">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.registrationNumber }}</div>
								<el-input v-else v-model="scope.row.registrationNumber"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="生产许可证" prop="licence">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.licence }}</div>
								<el-input v-else v-model="scope.row.licence"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="期初数量" prop="initialNumber" :render-header="requiredHeader">
							<template slot-scope="scope">
								<div v-if="editForm.serialNumberManagement" v-on:click="editEnterSerialNumberVisible = true">
									<el-button v-show="editForm.enterSerialNumberTable.length === 0" size="small">录入</el-button>
									<div class="pull-right" v-show="editForm.enterSerialNumberTable.length !== 0">{{ editForm.enterSerialNumberTable.length }}</div>
									<div class="pull-right jgb-brand" v-show="editForm.enterSerialNumberTable.length !== 0">SN</div>
									<div class="jgb-clearFloat">.</div>
								</div>
								<div v-else-if="!scope.row.editFlag&&!editForm.serialNumberManagement&&editForm.initSet">{{ scope.row.initialNumber }}</div>
								<el-input v-else v-model="scope.row.initialNumber" type="number" v-on:change="(value)=>editFormInitialNumberChange(value, scope.row)"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="单位成本" prop="unitCost">
							<template slot-scope="scope">
								<div v-if="!scope.row.editFlag">{{ scope.row.unitCost | doubleDecimals }}</div>
								<el-input v-else v-model="scope.row.unitCost" v-on:change="(value)=>editFormUnitCostChange(value, scope.row)"></el-input>
							</template>
						</el-table-column>
						<el-table-column label="起初总价" prop="atFirstTotalPrice">
							<template slot-scope="scope">
								{{ scope.row.atFirstTotalPrice | doubleDecimals }}
							</template>
						</el-table-column>
					</el-table>
				</el-col>
			</el-row>
		</el-form>
		<div slot="footer">
			<jgb-form-footer :loading="loading" v-on:save="saveEdit('editForm')" v-on:close="editVisible = false"></jgb-form-footer>
		</div>
	</el-dialog>
	<!-- 添加-序列号录入 -->
	<el-dialog :visible.sync="addEnterSerialNumberVisible" title="添加序列号录入">
		<el-button-group>
			<el-button v-on:click="addBatchSetWrap = false">基本录入序列号</el-button>
			<el-button v-on:click="addBatchSetWrap = true">批量录入序列号</el-button>
		</el-button-group>
		<div v-if="addBatchSetWrap" style="margin: 6px 0;">
			<div>
				<el-input v-model="addEnterSerialNumberForm.prefix" placeholder="输入前缀（可以为空）" style="width: 140px;"></el-input>
				<span>起始号：</span>
				<el-input v-model="addEnterSerialNumberForm.startNumber" value="001" style="width: 140px;" type="number"></el-input>
				<span>递增量</span>
				<el-input v-model="addEnterSerialNumberForm.increment" value="1" type="number" min="0" style="width: 110px;"></el-input>
				<span>个数</span>
				<el-input v-model="addEnterSerialNumberForm.number" value="1" type="number" min="0" style="width: 110px;"></el-input>
				<el-button v-on:click="addBatchGenerateSerialNumber">添加</el-button>
			</div>
			<div style="margin-top: 6px;">
				<el-input style="width: 652px;" placeholder="将word excel txt文档中的序列号复制粘贴到此处，支持以【空格、逗号、分号(英文格式)】分隔" v-model="addEnterSerialNumberForm.copy"></el-input>
				<el-button v-on:click="addCodyGenerateSerialNumber">添加</el-button>
			</div>
		</div>
		<div style="max-height: 300px;overflow-y: auto;">
			<el-table border ref="addEnterSerialNumberForm" :data="addEnterSerialNumberForm.table" style="margin-top: 6px;" v-on:row-click="addEnterSerialNumberFormRowClick">
				<el-table-column type="index" width="50px" label="序号"></el-table-column>
				<el-table-column label="操作">
					<template slot-scope="scope">
						<el-button-group>
							<el-button icon="el-icon-plus" v-on:click="handleAddEnterSerialNumberAddRow"></el-button>
							<el-button icon="el-icon-delete" type="danger" v-on:click="handleAddEnterSerialNumberDeleteRow(scope.row)"></el-button>
						</el-button-group>
					</template>
				</el-table-column>
				<el-table-column label="序列号" prop="serialNumber">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.serialNumber }}</div>
						<el-input v-else v-model="scope.row.serialNumber" v-on:blur="addEnterSerialNumberInputBlur(scope.row, scope.row.serialNumber, scope.row.index)"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="备注" prop="remark">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag&&!scope.row.isRepeat">{{ scope.row.remark }}</div>
						<div v-else-if="!scope.row.editFlag&&scope.row.isRepeat" style="color: #f00;">{{ scope.row.remark }}</div>
						<el-input v-else v-model="scope.row.remark"></el-input>
					</template>
				</el-table-column>
			</el-table>
		</div>
		<div slot="footer">
			<jgb-form-footer :loading="loading" v-on:save="saveAddSerialNumber" v-on:close="addEnterSerialNumberVisible = false"></jgb-form-footer>
		</div>
	</el-dialog>
	<!-- 编辑-序列号录入 -->
	<el-dialog :visible.sync="editEnterSerialNumberVisible" title="编辑序列号录入">
		<el-button-group>
			<el-button v-on:click="editBatchSetWrap = false">基本录入序列号</el-button>
			<el-button v-on:click="editBatchSetWrap = true">批量录入序列号</el-button>
		</el-button-group>
		<div v-if="editBatchSetWrap" style="margin: 6px 0;">
			<div>
				<el-input v-model="editEnterSerialNumberForm.prefix" placeholder="输入前缀（可以为空）" style="width: 140px;"></el-input>
				<span>起始号：</span>
				<el-input v-model="editEnterSerialNumberForm.startNumber" value="001" style="width: 140px;" type="number"></el-input>
				<span>递增量</span>
				<el-input v-model="editEnterSerialNumberForm.increment" value="1" type="number" min="0" style="width: 110px;"></el-input>
				<span>个数</span>
				<el-input v-model="editEnterSerialNumberForm.number" value="1" type="number" min="0" style="width: 110px;"></el-input>
				<el-button v-on:click="editBatchGenerateSerialNumber">添加</el-button>
			</div>
			<div style="margin-top: 6px;">
				<el-input style="width: 652px;" placeholder="将word excel txt文档中的序列号复制粘贴到此处，支持以【空格、逗号、分号(英文格式)】分隔" v-model="editEnterSerialNumberForm.copy"></el-input>
				<el-button v-on:click="editCodyGenerateSerialNumber">添加</el-button>
			</div>
		</div>
		<div style="max-height: 300px;overflow-y: auto;">
			<el-table border ref="editEnterSerialNumberForm" :data="editEnterSerialNumberForm.table" style="margin-top: 6px;" v-on:row-click="editEnterSerialNumberFormRowClick">
				<el-table-column type="index" width="50px" label="序号"></el-table-column>
				<el-table-column label="操作">
					<template slot-scope="scope">
						<el-button-group>
							<el-button icon="el-icon-plus" v-on:click="handleEditEnterSerialNumberAddRow"></el-button>
							<el-button icon="el-icon-delete" type="danger" v-on:click="handleEditEnterSerialNumberDeleteRow(scope.row)"></el-button>
						</el-button-group>
					</template>
				</el-table-column>
				<el-table-column label="序列号" prop="serialNumber">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag">{{ scope.row.serialNumber }}</div>
						<el-input v-else v-model="scope.row.serialNumber" v-on:blur="editEnterSerialNumberInputBlur(scope.row, scope.row.serialNumber, scope.row.index)"></el-input>
					</template>
				</el-table-column>
				<el-table-column label="备注" prop="remark">
					<template slot-scope="scope">
						<div v-if="!scope.row.editFlag&&!scope.row.isRepeat">{{ scope.row.remark }}</div>
						<div v-else-if="!scope.row.editFlag&&scope.row.isRepeat" style="color: #f00;">{{ scope.row.remark }}</div>
						<el-input v-else v-model="scope.row.remark"></el-input>
					</template>
				</el-table-column>
			</el-table>
		</div>
		<div slot="footer">
			<jgb-form-footer :loading="loading" v-on:save="saveEditSerialNumber" v-on:close="editEnterSerialNumberVisible = false"></jgb-form-footer>
		</div>
	</el-dialog>
	<transition name="slide-fade">
		<div class="details-wrap" v-show="isUnfold">
			<div class="details-inner" v-loading="loadingDetailInfo">
				<el-row class="row-border">
					<div class="title text-center">
						<h3>商品信息详情页</h3>
					</div>
					<el-col v-for="item in commodityInfo" :span="item.oneRow ? 24 : 12" class="text-center" :key="item.name">
						<div>{{ item.name }}</div>
						<div v-if="item.isImages" v-on:click="viewImage(item)"><i class="el-icon-picture"></i></div>
						<div v-else>{{ item.value }}</div>
					</el-col>
				</el-row>
				<div class="toggle-button-wrap" v-on:click="toggleInfo">
					<span class="jgbvue_arrow_icon" style="background: transparent url(../../assets/img/common/ats-icon_5.png) no-repeat scroll -9px -85px;position: absolute;top: 50%;right: 0;transform: translateY(-50%);"></span>
					<span class="jgbvue_arrow_line" style="background: transparent url(../../assets/img/common/ats-icon_5.png) no-repeat scroll -123px -2px;margin-left: 16px;"></span>
				</div>
			</div>
		</div>
	</transition>
	<transition name="fade">
		<div class="slideshow-wrap" v-if="showSlideshow">
			<div class="slideshow-mask" v-on:click="showSlideshow = false"></div>
			<div class="slideshow-inner">
				<div class="slideshow-inner-nav">
					<a class="index-text">{{ currentImgIndex+1 + '/' +  slideshowArr.length}}</a>
					<i class="el-icon-close" v-on:click="showSlideshow = false"></i>
				</div>
				<div class="slideshow-inner-wrap" :style="{width: currentImgWidth + 'px', height: currentImgHeight + 'px'}">
					<img :src="currentImgSrc" :style="{width:currentImgWidth+'px',height:currentImgHeight+'px'}"/>
					<i class="el-icon-arrow-right arrow-right arrow"  v-on:click="nextImg"></i>
					<i class="el-icon-arrow-left arrow-left arrow" v-on:click="prevImg"></i>
				</div>
			</div>
		</div>
	</transition>
	<el-dialog :visible.sync="importVisible" title="导入">
		<p>
			<span>导入模板下载并填写</span>
			<el-button>下载</el-button>
		</p>
		<p>
			填写说明：
			<ol>
				<li>多次或重复导入同一编号的客户，默认覆盖之前的信息</li>
				<li>客户编号、名称必填，多个联系人的客户信息只需填写一次。</li>
			</ol>
		</p>
		<p>
			<span>上传需要导入的文件</span>
			<form :action="uploadUrl" method="post" enctype="multipart/form-data">
			    <input type="file" v-on:change="getFile"></input>
		    </form>
		</p>
		<p>
			导入详情：
			<ul>
				<li>新增客户数据：{{ uploadInfo.newNumber }}条</li>
				<li>更新客户数据: {{ uploadInfo.updateNumber }}条</li>
				<li>错误数据：{{ uploadInfo.errNumber }}条</li>
				<li v-if="uploadInfo.errRecord.length !== 0">
					错误信息：
					<dl>
						<li v-for="item in uploadInfo.errRecord">
							导入文件中第{{item}}行，请检查
						</li>
					</dl>
				</li>
			</ul>
		</p>
		<div slot="footer">
			<el-button v-on:click="uploadFild">导入</el-button>
			<el-button v-on:click="importVisible = false">关闭</el-button>
		</div>
	</el-dialog>
	<el-dialog :visible.sync="exportVisible" title="导出">
		<p>
			<small>注：请选择需要导出的字段</small>
		</p>
		<el-checkbox v-for="item in exportForm" label="item.value" border v-model="item.checked" :key="item.value">{{item.name}}</el-checkbox>
		<div slot="footer">
			<el-button>导出</el-button>
			<el-button v-on:click="exportVisible = false">关闭</el-button>
		</div>
	</el-dialog>
	<el-dialog :visible.sync="showColumnSetting">
        <div class="title" slot="title">列设置</div>
        <jgb-column-setting v-if="table.header.length" v-model="table.header"></jgb-column-setting>
        <div slot="footer">
            <el-button v-on:click="btnColumnSettingReset">恢复默认设置</el-button>
          	<el-button type="primary" v-on:click="btnColumnSettingComplete">完成</el-button>
        </div>
     </el-dialog>
     <!-- 新增多计量单位窗口 -->
     <el-dialog title="新增多计量单位" :visible.sync="addNewMultipleDialogVisible">
     	<el-form :model="newUnit" :rules="formRules" label-position="left" label-width="100px" ref="newUnitForm">
     		<div>
     			<el-form-item label="基本单位" prop="jibendanwei">
	     			<el-input v-model="newUnit.jibendanwei"></el-input>
	     			基本单位应为最小度量单位
	     		</el-form-item>
     		</div>
     		<div v-for="(fdw, index) in newUnit.fudanwei" :key="index" style="margin-bottom: 6px;">
     			<i class="el-icon-delete" style="color: #ff0000;cursor: pointer;" v-on:click="removeFdw(fdw)"></i>
     			<span>副单位 {{ index + 1 }}</span>
     			<el-input v-model="fdw.value" style="display: inline-block;width: 170px;"></el-input>
     			<span>=</span>
     			<el-input v-model="fdw.beishu" style="display: inline-block;width: 170px;" type="number" min="1"></el-input>
     			{{ newUnit.jibendanwei }}
     		</div>
     	</el-form>
     	<el-button v-on:click.prevent="addFwd">增加单位</el-button>
     	<div slot="footer">
     		<jgb-form-footer :loading="loading" v-on:save="saveMultiple('newUnitForm')" v-on:close="addNewMultipleDialogVisible = false"></jgb-form-footer>
     	</div>
     </el-dialog>
</div>
</body>
<script type="text/javascript" src="../../vue/vue.js"></script>
<script type="text/javascript" src="../../axios/axios.min.js"></script>
<script type="text/javascript" src="../../element-ui-2.0.11/lib/index.js"></script>
<script type="text/javascript" src="../../assets/js/common.js"></script>
<script type="text/javascript" src="../../assets/js/views/commodityManagement/commodityInfo.js"></script>
<script type="text/javascript">
	/**
	 * 查询接口
	 * 获取快速查询选项接口
	 * 获取多单位选项
	 * 获取辅助属性分类
	 * 获取仓库
	 * 切换状态
	 * 删除table
	 * 查看table
	 * 保存添加
	 * 获取编辑数据
	 * 保存编辑
	 * 上传信息
	 * 导出
	 * 切换是否常用
	 * 获取轮播（可以从数据获取）
	 * 添加辅助属性分类
	 * 获取默认列设置
	 * 列设置完成
	 * 检查编号是否重复
	 */
	JGBVue.module.commodityInfo().init('/commodityInfo/search', '/commodityInfo/getQuickQuery', '/commodityInfo/duodanwei','/commodityInfo/getAuxiliaryAttributesClassify', '/common/getRepo', '/common/switch', '/common/data_delete', '/commodityInfo/examine', '/common/data_add_save', '/commodityInfo/edit_data_get', '/common/data_edit_save', '/common/upload_info', '/clientInfo/exportForm', '/commodityInfo/toggleCommonUse', '/common/slideshow', '/commodityInfo/quickGenerate', '/common/data_add_save', '/commodityInfo/defaultColumnSettingUrl', '/equipmentManagement/columnSettingComplete', '/commodityInfo/checkNumber');
</script>
</html>